<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>G·ª≠i ƒê·∫∑ng Huy·ªÅn Trang ‚ù§Ô∏è</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* --- C·∫§U H√åNH C∆† B·∫¢N --- */
body {
    margin: 0;
    height: 100vh;
    /* N·ªÅn chuy·ªÉn m√†u h·ªìng l√£ng m·∫°n */
    background: linear-gradient(135deg, #ff6a88, #ff99ac);
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    font-family: 'Segoe UI', sans-serif;
    color: white;
    text-align: center;
    transition: background 1s ease; /* Hi·ªáu ·ª©ng chuy·ªÉn n·ªÅn m∆∞·ª£t */
}

/* L·ªõp ph·ªß t·ªëi m√†n h√¨nh khi b·∫Øn ph√°o hoa */
#dark-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: #000;
    opacity: 0; /* Ban ƒë·∫ßu kh√¥ng hi·ªán */
    z-index: 8; /* N·∫±m tr√™n tim bay nh∆∞ng d∆∞·ªõi ph√°o hoa */
    pointer-events: none;
    transition: opacity 1.5s ease;
}

/* --- CANVAS PH√ÅO HOA --- */
#canvas {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    z-index: 9; /* N·ªïi b·∫≠t tr√™n n·ªÅn t·ªëi */
    pointer-events: none;
}

/* --- B√ÅNH SINH NH·∫¨T --- */
#cake-container {
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%) scale(0.5);
    z-index: 15; /* N·ªïi tr√™n t·∫•t c·∫£ khi hi·ªán */
    opacity: 0;
    transition: all 1s ease-out;
    display: none; /* Ban ƒë·∫ßu ·∫©n */
}
#cake-container img {
    width: 250px; height: auto;
    filter: drop-shadow(0 0 20px rgba(255,255,100,0.8));
    animation: cakeBounce 2s infinite ease-in-out;
}
@keyframes cakeBounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

/* --- N·ªòI DUNG CH√çNH --- */
#content {
    display: none; /* Ban ƒë·∫ßu ·∫©n */
    padding: 20px;
    z-index: 10;
    position: relative;
    animation: fadeContentIn 2s ease;
}
@keyframes fadeContentIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

/* N√∫t b·∫•m ban ƒë·∫ßu */
#start {
    font-size: 1.4em;
    padding: 20px 30px;
    border: 2px solid #fff;
    border-radius: 15px;
    cursor: pointer;
    background: rgba(255,255,255,0.2);
    z-index: 20;
    animation: pulse 1.5s infinite;
    user-select: none;
}
@keyframes pulse { 50% { transform: scale(1.05); } }

h1 { animation: glow 2s infinite alternate; }
@keyframes glow { to { text-shadow: 0 0 25px #ff0033; } }

.images img {
    width: 130px; height: 130px;
    border-radius: 15px; margin: 8px;
    object-fit: cover; border: 3px solid #fff;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

/* --- TIM BAY --- */
.heart {
    position: fixed; bottom: -20px;
    animation: floatUp 6s linear infinite;
    z-index: 5; opacity: 0.8;
}
@keyframes floatUp { to { transform: translateY(-110vh); opacity: 0; } }

#qrcode { margin: 15px auto; background: white; padding: 10px; border-radius: 12px; width: max-content; }
</style>
</head>

<body>

<div id="dark-overlay"></div>

<canvas id="canvas"></canvas>

<div id="cake-container">
    <img src="https://cdn-icons-png.flaticon.com/512/9694/9694944.png" alt="Birthday Cake">
    <h2 style="color:#fff000; margin-top:10px;">Make a Wish! ‚ú®</h2>
</div>

<div id="start">üëâ Ch·∫°m v√†o ƒë√¢y n√® p√© iu üíñ</div>

<div id="content">
    <h1>üéâ Ch√∫c m·ª´ng sinh nh·∫≠t üéâ<br>ƒê·∫∑ng Huy·ªÅn Trang üíï</h1>

    <div class="images">
        <img src="https://iili.io/f84P5wF.md.png" alt="·∫¢nh 1">
        <img src="https://iili.io/f84icb9.md.png" alt="·∫¢nh 2">
    </div>

    <p style="font-size: 1.1em; line-height: 1.6;">
        P√© iu c·ªßa anh ü•∞<br>
        Ch√∫c em tu·ªïi m·ªõi th·∫≠t nhi·ªÅu ni·ªÅm vui v√† h·∫°nh ph√∫c ‚ú®<br>
        Anh y√™u em nhi·ªÅu l·∫Øm üòò
    </p>

    <h2 id="preCountdown" style="display:none; font-size:3em; color:#fff000;"></h2>
    <h2 id="endMessage" style="display:none; font-size:1.6em; color:#fff000; margin-top: 20px;">
        Ch√∫c Trang c·ªßa anh sinh nh·∫≠t vui v·∫ª ‚ù§Ô∏è
    </h2>
    
    <div id="countdown-area">
        <h3>‚è≥ Sinh nh·∫≠t ƒë·∫øn sau:</h3>
        <div id="countdown" style="font-weight:bold; font-size:1.2em;"></div>
    </div>

    <div style="margin-top:30px;">
        <small>Qu√©t QR ƒë·ªÉ m·ªü tr√™n ƒëi·ªán tho·∫°i</small>
        <div id="qrcode"></div>
    </div>
</div>


<audio id="music" loop>
    <source src="https://cdn.pixabay.com/audio/2022/10/30/audio_0a6b7f0c7f.mp3" type="audio/mpeg">
</audio>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<script>
/* --- 1. K·ªäCH B·∫¢N CH√çNH (SEQUENCE) --- */
const startBtn = document.getElementById("start");
const contentDiv = document.getElementById("content");
const darkOverlay = document.getElementById("dark-overlay");
const cakeContainer = document.getElementById("cake-container");
const music = document.getElementById("music");

// X·ª≠ l√Ω khi b·∫•m n√∫t START
startBtn.onclick = () => {
    // B∆∞·ªõc 1: ·∫®n n√∫t, b·∫≠t nh·∫°c
    startBtn.style.display = "none";
    music.play().catch(()=>{}); // C·ªë g·∫Øng ph√°t nh·∫°c

    // B∆∞·ªõc 2: L√†m t·ªëi m√†n h√¨nh v√† b·∫Øn ph√°o hoa
    darkOverlay.style.opacity = "0.95"; // T·ªëi m√†n h√¨nh
    startFireworks(); // B·∫Øt ƒë·∫ßu b·∫Øn

    // B∆∞·ªõc 3: Sau 7 gi√¢y, d·ª´ng ph√°o hoa, hi·ªán b√°nh
    setTimeout(() => {
        stopFireworks(); // D·ª´ng b·∫Øn
        
        // Hi·ªán b√°nh
        cakeContainer.style.display = "block";
        setTimeout(() => {
            cakeContainer.style.opacity = "1";
            cakeContainer.style.transform = "translate(-50%, -50%) scale(1)";
        }, 50); // Delay nh·∫π ƒë·ªÉ hi·ªáu ·ª©ng transition ho·∫°t ƒë·ªông

        // B∆∞·ªõc 4: Sau 3.5 gi√¢y ng·∫Øm b√°nh, chuy·ªÉn sang n·ªôi dung ch√≠nh
        setTimeout(() => {
            // ·∫®n b√°nh v√† l·ªõp ph·ªß t·ªëi
            cakeContainer.style.opacity = "0";
            cakeContainer.style.transform = "translate(-50%, -50%) scale(0.8)";
            darkOverlay.style.opacity = "0";
            setTimeout(() => cakeContainer.style.display = "none", 1000);

            // Hi·ªán n·ªôi dung ch√≠nh v√† tim bay
            contentDiv.style.display = "block";
            setInterval(createHeart, 400); // B·∫Øt ƒë·∫ßu tim bay
            checkBirthdayLogic(); // Ki·ªÉm tra ng√†y ƒë·ªÉ hi·ªán l·ªùi ch√∫c

        }, 3500); // Th·ªùi gian hi·ªán b√°nh

    }, 7000); // Th·ªùi gian b·∫Øn ph√°o hoa
};


/* --- 2. C√ÅC H√ÄM H·ªñ TR·ª¢ (Tim bay, ƒê·∫øm ng∆∞·ª£c...) --- */

function checkBirthdayLogic(){
    const pre = document.getElementById("preCountdown");
    const endMsg = document.getElementById("endMessage");
    const countdownArea = document.getElementById("countdown-area");
    
    const today = new Date();
    // Th√°ng 1 l√† 0. S·ª≠a l·∫°i ng√†y ·ªü ƒë√¢y n·∫øu c·∫ßn test.
    const isTestDay = (today.getDate() === 14 && today.getMonth() === 0); 
    const isBirthday = (today.getDate() === 15 && today.getMonth() === 0);

    if(isTestDay || isBirthday){
        // N·∫øu ƒë√∫ng ng√†y, ·∫©n ƒë·∫øm ng∆∞·ª£c, hi·ªán l·ªùi ch√∫c
        countdownArea.style.display = "none";
        endMsg.style.display = "block";
        // Hi·ªáu ·ª©ng ch·ªØ Happy Birthday nh·∫•p nh√°y nh·∫π
        setInterval(() => {
            endMsg.style.textShadow = endMsg.style.textShadow ? "" : "0 0 20px #ffff00";
        }, 1000);
    }
}

// T·∫°o tim bay
function createHeart(){
    const h = document.createElement("div");
    h.className = "heart"; h.innerHTML = "‚ù§Ô∏è";
    h.style.left = Math.random() * 100 + "vw";
    h.style.fontSize = Math.random() * 20 + 15 + "px";
    h.style.animationDuration = Math.random() * 2 + 3 + "s";
    document.body.appendChild(h);
    setTimeout(() => h.remove(), 6000);
}

// ƒê·∫øm ng∆∞·ª£c
const now = new Date();
let birthday = new Date(now.getFullYear(), 0, 15);
if(birthday < now) birthday = new Date(now.getFullYear() + 1, 0, 15);
setInterval(() => {
    const d = birthday - new Date();
    const days = Math.floor(d / 86400000);
    const hours = Math.floor((d % 86400000) / 3600000);
    const minutes = Math.floor((d % 3600000) / 60000);
    document.getElementById("countdown").innerText = `${days} ng√†y ${hours} gi·ªù ${minutes} ph√∫t`;
}, 1000);

// QR Code
new QRCode(document.getElementById("qrcode"), {
    text: location.origin + location.pathname,
    width: 120, height: 120, colorDark : "#ff3366", colorLight : "#ffffff"
});


/* --- 3. H·ªÜ TH·ªêNG PH√ÅO HOA (ƒê√£ th√™m ch·ª©c nƒÉng D·ª´ng) --- */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
let cw = window.innerWidth; let ch = window.innerHeight;
canvas.width = cw; canvas.height = ch;
window.addEventListener('resize', () => { cw = window.innerWidth; ch = window.innerHeight; canvas.width = cw; canvas.height = ch; });

let fireworks = []; let particles = [];
let hue = 120; let timerTotal = 25; let timerTick = 0;
let isFireworksPlaying = false; // Bi·∫øn ki·ªÉm so√°t tr·∫°ng th√°i b·∫Øn

function random(min, max) { return Math.random() * (max - min) + min; }

class Firework {
    constructor(sx, sy, tx, ty) {
        this.x = sx; this.y = sy; this.sx = sx; this.sy = sy; this.tx = tx; this.ty = ty;
        this.distanceToTarget = Math.sqrt(Math.pow(tx - sx, 2) + Math.pow(ty - sy, 2));
        this.distanceTraveled = 0; this.coordinates = []; this.coordinateCount = 3;
        while(this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
        this.angle = Math.atan2(ty - sy, tx - sx); this.speed = 2; this.acceleration = 1.05; this.brightness = random(60, 80); this.targetRadius = 1;
    }
    update(index) {
        this.coordinates.pop(); this.coordinates.unshift([this.x, this.y]);
        this.targetRadius < 8 ? this.targetRadius += 0.3 : this.targetRadius = 1;
        this.speed *= this.acceleration;
        let vx = Math.cos(this.angle) * this.speed; let vy = Math.sin(this.angle) * this.speed;
        this.distanceTraveled = Math.sqrt(Math.pow(this.sx - this.x - vx, 2) + Math.pow(this.sy - this.y - vy, 2));
        if(this.distanceTraveled >= this.distanceToTarget) {
            createParticles(this.tx, this.ty); fireworks.splice(index, 1);
        } else { this.x += vx; this.y += vy; }
    }
    draw() {
        ctx.beginPath(); ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
        ctx.lineTo(this.x, this.y); ctx.strokeStyle = 'hsl(' + hue + ', 100%, ' + this.brightness + '%)'; ctx.stroke();
    }
}

class Particle {
    constructor(x, y) {
        this.x = x; this.y = y; this.coordinates = []; this.coordinateCount = 5;
        while(this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
        this.angle = random(0, Math.PI * 2); this.speed = random(1, 10); this.friction = 0.95; this.gravity = 1; this.hue = random(hue - 50, hue + 50); this.brightness = random(50, 80); this.alpha = 1; this.decay = random(0.015, 0.03);
    }
    update(index) {
        this.coordinates.pop(); this.coordinates.unshift([this.x, this.y]);
        this.speed *= this.friction; this.x += Math.cos(this.angle) * this.speed; this.y += Math.sin(this.angle) * this.speed + this.gravity;
        this.alpha -= this.decay; if(this.alpha <= this.decay) { particles.splice(index, 1); }
    }
    draw() {
        ctx.beginPath(); ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
        ctx.lineTo(this.x, this.y); ctx.strokeStyle = 'hsla(' + this.hue + ', 100%, ' + this.brightness + '%, ' + this.alpha + ')'; ctx.stroke();
    }
}

function createParticles(x, y) { let particleCount = 40; while(particleCount--) { particles.push(new Particle(x, y)); } }

function loop() {
    if (!isFireworksPlaying) return; // N·∫øu b·ªã d·ª´ng th√¨ tho√°t v√≤ng l·∫∑p
    requestAnimationFrame(loop);
    hue += 0.5;
    ctx.globalCompositeOperation = 'destination-out';
    ctx.fillStyle = 'rgba(0, 0, 0, 0.5)'; ctx.fillRect(0, 0, cw, ch);
    ctx.globalCompositeOperation = 'lighter';
    let i = fireworks.length; while(i--) { fireworks[i].draw(); fireworks[i].update(i); }
    let j = particles.length; while(j--) { particles[j].draw(); particles[j].update(j); }
    if(timerTick >= timerTotal) { fireworks.push(new Firework(cw / 2, ch, random(0, cw), random(0, ch / 2))); timerTick = 0; } else { timerTick++; }
}

// H√†m b·∫Øt ƒë·∫ßu b·∫Øn
function startFireworks() {
    if (isFireworksPlaying) return;
    isFireworksPlaying = true;
    loop();
}

// H√†m d·ª´ng b·∫Øn v√† x√≥a canvas
function stopFireworks() {
    isFireworksPlaying = false;
    setTimeout(() => { ctx.clearRect(0, 0, cw, ch); }, 100); // X√≥a s·∫°ch t√†n d∆∞
}
</script>

</body>
</html>
