<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>G·ª≠i ƒê·∫∑ng Huy·ªÅn Trang ‚ù§Ô∏è</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* --- C·∫§U H√åNH C∆† B·∫¢N --- */
body {
    margin: 0; height: 100vh;
    background: linear-gradient(135deg, #ff6a88, #ff99ac);
    display: flex; justify-content: center; align-items: center;
    overflow: hidden; font-family: 'Segoe UI', sans-serif;
    color: white; text-align: center;
    transition: background 1s ease;
}

/* L·ªõp ph·ªß t·ªëi m√†n h√¨nh */
#dark-overlay {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: #000; opacity: 0; z-index: 8;
    pointer-events: none; transition: opacity 1.5s ease;
}

/* --- CANVAS PH√ÅO HOA --- */
#canvas {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    z-index: 9; pointer-events: none;
}

/* --- B√ÅNH SINH NH·∫¨T --- */
#cake-container {
    position: fixed; top: 50%; left: 50%;
    transform: translate(-50%, -50%) scale(0.5);
    z-index: 15; opacity: 0; transition: all 1s ease-out;
    display: none;
}
#cake-container img {
    width: 250px; height: auto;
    filter: drop-shadow(0 0 20px rgba(255,255,100,0.8));
    animation: cakeBounce 2s infinite ease-in-out;
}
@keyframes cakeBounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

/* --- N·ªòI DUNG CH√çNH --- */
#content {
    display: none; padding: 20px; z-index: 10;
    position: relative; animation: fadeContentIn 2s ease;
}
@keyframes fadeContentIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

#start {
    font-size: 1.4em; padding: 20px 30px;
    border: 2px solid #fff; border-radius: 15px;
    cursor: pointer; background: rgba(255,255,255,0.2);
    z-index: 20; animation: pulse 1.5s infinite; user-select: none;
}
@keyframes pulse { 50% { transform: scale(1.05); } }

h1 { animation: glow 2s infinite alternate; }
@keyframes glow { to { text-shadow: 0 0 25px #ff0033; } }

.images img {
    width: 130px; height: 130px; border-radius: 15px; margin: 8px;
    object-fit: cover; border: 3px solid #fff;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.heart {
    position: fixed; bottom: -20px;
    animation: floatUp 6s linear infinite; z-index: 5; opacity: 0.8;
}
@keyframes floatUp { to { transform: translateY(-110vh); opacity: 0; } }

#qrcode { margin: 15px auto; background: white; padding: 10px; border-radius: 12px; width: max-content; }
</style>
</head>

<body>

<div id="dark-overlay"></div>
<canvas id="canvas"></canvas>

<div id="cake-container">
    <img src="https://cdn-icons-png.flaticon.com/512/9694/9694944.png" alt="Birthday Cake">
    <h2 style="color:#fff000; margin-top:10px;">Make a Wish! ‚ú®</h2>
</div>

<div id="start">üëâ Ch·∫°m v√†o ƒë√¢y n√® p√© iu üíñ</div>

<div id="content">
    <h1>üéâ Ch√∫c m·ª´ng sinh nh·∫≠t üéâ<br>ƒê·∫∑ng Huy·ªÅn Trang üíï</h1>

    <div class="images">
        <img src="https://iili.io/f84P5wF.md.png" alt="·∫¢nh 1">
        <img src="https://iili.io/f84icb9.md.png" alt="·∫¢nh 2">
    </div>

    <p style="font-size: 1.1em; line-height: 1.6;">
        P√© iu c·ªßa anh ü•∞<br>
        Ch√∫c em tu·ªïi m·ªõi th·∫≠t nhi·ªÅu ni·ªÅm vui v√† h·∫°nh ph√∫c ‚ú®<br>
        Anh y√™u em nhi·ªÅu l·∫Øm üòò
    </p>

    <h2 id="endMessage" style="display:none; font-size:1.6em; color:#fff000; margin-top: 20px;">
        Ch√∫c Trang c·ªßa anh sinh nh·∫≠t vui v·∫ª ‚ù§Ô∏è
    </h2>
    
    <div id="countdown-area">
        <h3>‚è≥ Sinh nh·∫≠t ƒë·∫øn sau:</h3>
        <div id="countdown" style="font-weight:bold; font-size:1.2em;"></div>
    </div>

    <div style="margin-top:30px;">
        <small>Qu√©t QR ƒë·ªÉ m·ªü tr√™n ƒëi·ªán tho·∫°i</small>
        <div id="qrcode"></div>
    </div>
</div>

<audio id="music" loop>
    <source src="cmsn.mp3" type="audio/mpeg">
</audio>

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<script>
/* --- LOGIC CH√çNH --- */
const startBtn = document.getElementById("start");
const contentDiv = document.getElementById("content");
const darkOverlay = document.getElementById("dark-overlay");
const cakeContainer = document.getElementById("cake-container");
const music = document.getElementById("music");

startBtn.onclick = () => {
    startBtn.style.display = "none";
    
    // Ph√°t nh·∫°c ngay khi ch·∫°m
    music.play().then(() => {
        console.log("Music playing...");
    }).catch(e => {
        console.log("Music blocked or file not found. Check filename 'cmsn.mp3'");
        alert("L∆∞u √Ω: N·∫øu kh√¥ng nghe th·∫•y nh·∫°c, h√£y ki·ªÉm tra file 'cmsn.mp3' ƒë√£ n·∫±m c√πng th∆∞ m·ª•c ch∆∞a nh√©!");
    });

    darkOverlay.style.opacity = "0.95";
    startFireworks(); // B·∫Øn ph√°o hoa

    // K·ªãch b·∫£n: B·∫Øn ph√°o hoa 7s -> Hi·ªán b√°nh 3.5s -> Hi·ªán l·ªùi ch√∫c
    setTimeout(() => {
        stopFireworks();
        cakeContainer.style.display = "block";
        setTimeout(() => {
            cakeContainer.style.opacity = "1";
            cakeContainer.style.transform = "translate(-50%, -50%) scale(1)";
        }, 50);

        setTimeout(() => {
            cakeContainer.style.opacity = "0";
            cakeContainer.style.transform = "translate(-50%, -50%) scale(0.8)";
            darkOverlay.style.opacity = "0";
            setTimeout(() => cakeContainer.style.display = "none", 1000);

            contentDiv.style.display = "block";
            setInterval(createHeart, 400);
            checkBirthdayLogic();
        }, 3500); 
    }, 7000); 
};

function checkBirthdayLogic(){
    const endMsg = document.getElementById("endMessage");
    const countdownArea = document.getElementById("countdown-area");
    const today = new Date();
    // Logic check ng√†y 14 (test) v√† 15 (sinh nh·∫≠t)
    if((today.getDate() === 14 || today.getDate() === 15) && today.getMonth() === 0){
        countdownArea.style.display = "none";
        endMsg.style.display = "block";
        setInterval(() => {
            endMsg.style.textShadow = endMsg.style.textShadow ? "" : "0 0 20px #ffff00";
        }, 1000);
    }
}

function createHeart(){
    const h = document.createElement("div");
    h.className = "heart"; h.innerHTML = "‚ù§Ô∏è";
    h.style.left = Math.random() * 100 + "vw";
    h.style.fontSize = Math.random() * 20 + 15 + "px";
    h.style.animationDuration = Math.random() * 2 + 3 + "s";
    document.body.appendChild(h);
    setTimeout(() => h.remove(), 6000);
}

const now = new Date();
let birthday = new Date(now.getFullYear(), 0, 15);
if(birthday < now) birthday = new Date(now.getFullYear() + 1, 0, 15);
setInterval(() => {
    const d = birthday - new Date();
    document.getElementById("countdown").innerText = 
        `${Math.floor(d / 86400000)} ng√†y ${Math.floor((d % 86400000) / 3600000)} gi·ªù ${Math.floor((d % 3600000) / 60000)} ph√∫t`;
}, 1000);

new QRCode(document.getElementById("qrcode"), {
    text: location.origin + location.pathname,
    width: 120, height: 120, colorDark : "#ff3366", colorLight : "#ffffff"
});

/* --- PH√ÅO HOA --- */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
let cw = window.innerWidth; let ch = window.innerHeight;
canvas.width = cw; canvas.height = ch;
window.addEventListener('resize', () => { cw = window.innerWidth; ch = window.innerHeight; canvas.width = cw; canvas.height = ch; });

let fireworks = [], particles = [];
let hue = 120, timerTotal = 25, timerTick = 0, isFireworksPlaying = false;

function random(min, max) { return Math.random() * (max - min) + min; }

class Firework {
    constructor(sx, sy, tx, ty) {
        this.x = sx; this.y = sy; this.sx = sx; this.sy = sy; this.tx = tx; this.ty = ty;
        this.distanceToTarget = Math.sqrt(Math.pow(tx - sx, 2) + Math.pow(ty - sy, 2));
        this.distanceTraveled = 0; this.coordinates = []; this.coordinateCount = 3;
        while(this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
        this.angle = Math.atan2(ty - sy, tx - sx); this.speed = 2; this.acceleration = 1.05; this.brightness = random(60, 80); this.targetRadius = 1;
    }
    update(index) {
        this.coordinates.pop(); this.coordinates.unshift([this.x, this.y]);
        this.targetRadius < 8 ? this.targetRadius += 0.3 : this.targetRadius = 1;
        this.speed *= this.acceleration;
        let vx = Math.cos(this.angle) * this.speed; let vy = Math.sin(this.angle) * this.speed;
        this.distanceTraveled = Math.sqrt(Math.pow(this.sx - this.x - vx, 2) + Math.pow(this.sy - this.y - vy, 2));
        if(this.distanceTraveled >= this.distanceToTarget) {
            createParticles(this.tx, this.ty); fireworks.splice(index, 1);
        } else { this.x += vx; this.y += vy; }
    }
    draw() {
        ctx.beginPath(); ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
        ctx.lineTo(this.x, this.y); ctx.strokeStyle = 'hsl(' + hue + ', 100%, ' + this.brightness + '%)'; ctx.stroke();
    }
}
class Particle {
    constructor(x, y) {
        this.x = x; this.y = y; this.coordinates = []; this.coordinateCount = 5;
        while(this.coordinateCount--) { this.coordinates.push([this.x, this.y]); }
        this.angle = random(0, Math.PI * 2); this.speed = random(1, 10); this.friction = 0.95; this.gravity = 1; this.hue = random(hue - 50, hue + 50); this.brightness = random(50, 80); this.alpha = 1; this.decay = random(0.015, 0.03);
    }
    update(index) {
        this.coordinates.pop(); this.coordinates.unshift([this.x, this.y]);
        this.speed *= this.friction; this.x += Math.cos(this.angle) * this.speed; this.y += Math.sin(this.angle) * this.speed + this.gravity;
        this.alpha -= this.decay; if(this.alpha <= this.decay) { particles.splice(index, 1); }
    }
    draw() {
        ctx.beginPath(); ctx.moveTo(this.coordinates[this.coordinates.length - 1][0], this.coordinates[this.coordinates.length - 1][1]);
        ctx.lineTo(this.x, this.y); ctx.strokeStyle = 'hsla(' + this.hue + ', 100%, ' + this.brightness + '%, ' + this.alpha + ')'; ctx.stroke();
    }
}
function createParticles(x, y) { let particleCount = 40; while(particleCount--) { particles.push(new Particle(x, y)); } }

function loop() {
    if (!isFireworksPlaying) return;
    requestAnimationFrame(loop); hue += 0.5;
    ctx.globalCompositeOperation = 'destination-out'; ctx.fillStyle = 'rgba(0, 0, 0, 0.5)'; ctx.fillRect(0, 0, cw, ch);
    ctx.globalCompositeOperation = 'lighter';
    let i = fireworks.length; while(i--) { fireworks[i].draw(); fireworks[i].update(i); }
    let j = particles.length; while(j--) { particles[j].draw(); particles[j].update(j); }
    if(timerTick >= timerTotal) { fireworks.push(new Firework(cw / 2, ch, random(0, cw), random(0, ch / 2))); timerTick = 0; } else { timerTick++; }
}
function startFireworks() { if (!isFireworksPlaying) { isFireworksPlaying = true; loop(); } }
function stopFireworks() { isFireworksPlaying = false; setTimeout(() => { ctx.clearRect(0, 0, cw, ch); }, 100); }
</script>

</body>
</html>
